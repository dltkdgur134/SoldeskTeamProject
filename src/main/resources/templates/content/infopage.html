<!DOCTYPE html>
<html xmlns:th="http//www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/default}">
<head>
<script
	src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.4/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link th:fragment="css" th:href="@{/css/custom.css}" rel="stylesheet" />
<script th:src="@{/js/initialize.js}"></script>
<script th:src="@{/js/zipcode.js}"></script>
<script th:src="@{/js/update.js}"></script>
</head>
<div layout:fragment="content" class="container py-5">
	<div class="container text-center">
		<div class="row justify-content-md-center">
			<div class="col col-lg-2">
				<a type="button" class="btn btn-link position-relative" id="profile-pic-btn" data-bs-toggle="modal" data-bs-target="#updateProfilePicModal">
					<img src="https://randomuser.me/api/portraits/men/64.jpg" class="rounded-circle img-thumbnail img-fluid" alt="Profile Picture" id="profile-pic">
					<span class="position-absolute top-100 start-50 translate-middle p-1 bg-light rounded-circle" id="profile-pic-update-btn">
	    				<i class="fa-solid fa-pen-to-square"></i>
	  				</span>
				</a>
			</div>
			<div class="col col-lg-2">
			<h5 id="profile-nickName" th:text="${#authentication.principal.user.nickName}"></h5>
			<span class="badge rounded-pill text-bg-primary justify-content-center" th:text="${#authentication.principal.user.UserRole}"></span></div>
			<!-- <div class="col col-lg-2"><img th:src="@{${#authentication.principal.user.userProfilePath}}" class="img-thumbnail" alt="프로필 사진"></div> -->
			<div class="col col-lg-2"></div>
		</div>
	</div>
	<br>
	<div class="card info-card p-4">
		<h6 class="card-title">
			프로필 <a href="mypage" data-bs-toggle="tooltip"
				data-bs-placement="right" title="프로필 수정"><i class="fa-solid fa-pen-to-square"></i></a>
		</h6>
		<div class="card-body">
			<ul class="list-group list-group-flush">
				<li class="list-group-item d-flex justify-content-between"><Label>아이디</Label><strong th:text="${#authentication.principal.user.userId}"></strong>
  				</li>
				<li class="list-group-item d-flex justify-content-between"><Label>닉네임</Label>
				<strong th:text="${#authentication.principal.user.nickName}"></strong>
					<a type="button" class="btn btn-secondary btn-sm" data-bs-toggle="modal" data-bs-target="#updateNicknameModal">수정</a>
				</li>
			</ul>
		</div>
	</div>
	<div class="modal fade" id="updateNicknameModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="updateNicknameModalLabel" aria-hidden="true">
  		<div class="modal-dialog">
    		<div class="modal-content">
      			<div class="modal-header">
        			<h1 class="modal-title fs-5" id="updateNicknameModalLabel">닉네임 변경</h1>
        			<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
     	 		</div>
      			<div class="modal-body">
       				 <form th:action="@{/content/updateNickname}" method="post" name="upnickform"
						autocomplete="off" class="needs-validation" id="update-nickname-form"
						novalidate>
						<div class="input-group mb-3">
							<span class="input-group-text" id="basic-addon2">
							<i class="fa-solid fa-id-card"></i></span> 
							<input type="text" class="form-control" placeholder="온달" aria-label="nickname" name="nickname" id="nickname-input"
								aria-describedby="basic-addon2" maxlength="30" th:value="${#authentication.principal.user.nickName}">
							<div class="invalid-feedback">
     							닉네임을 확인해주세요. <i data-bs-toggle="tooltip"
				data-bs-placement="right" title="닉네임은 최소 1글자이어야 하고 기존 닉네임과 일치 시 변경하실 수 없습니다." class="fa-solid fa-circle-question"></i>
   			 				</div>
   			 				<div class="valid-feedback">
     							닉네임 변경이 가능합니다.
   			 				</div>
						</div>
					</form>	
      			</div>
      			<div class="modal-footer">
        			<button type="submit" class="btn btn-primary" form="update-nickname-form" id="update-nickname-btn">변경</button>
        			<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
      			</div>
    		</div>
  		</div>
	</div>
	<div class="modal fade" id="updateProfilePicModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="updateProfilePicModalLabel" aria-hidden="true">
  		<div class="modal-dialog">
    		<div class="modal-content">
      			<div class="modal-header">
        			<h1 class="modal-title fs-5" id="updateProfilePicModalLabel">프로필 사진 변경</h1>
        			<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
     	 		</div>
      			<div class="modal-body">
       				 <form th:action="@{/content/updateProfilePic}" method="post" 
						autocomplete="off" id="update-profilePic-form">
						<div class="input-group mb-3">
							<span class="input-group-text" id="basic-addon2">
							<i class="fa-solid fa-folder-open input-icon"></i></span>
							
							<!-- 숨겨진 진짜 파일 input -->
			  				<input type="file" id="profileImage" name="profileImage" accept="image/*" hidden>

			  				<!-- 사용자가 클릭하는 커스텀 버튼 -->
			  				<label for="profileImage" class="custom-file-label">프로필 사진 선택</label>

			  				<!-- 선택된 파일명 보여주기 -->
			  				<span id="file-name-display" class="file-name">이미지를 선택해주세요</span>
						</div>
					</form>	
      			</div>
      			<div class="modal-footer">
        			<button type="submit" class="btn btn-primary" form="update-profilePic-form">변경</button>
        			<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
      			</div>
    		</div>
  		</div>
	</div>
	<br>
	<div class="card info-card p-4">
		<h6 class="card-title">
			개인 정보 <a href="mypage" data-bs-toggle="tooltip"
				data-bs-placement="right" title="개인정보 수정"><i
				class="fa-solid fa-pen-to-square"></i></a>
		</h6>
		<div class="card-body">
			<ul class="list-group list-group-flush">
				<li class="list-group-item d-flex justify-content-between"><Label>이메일</Label><strong th:text="${#authentication.principal.user.email}"> </strong></li>
				<li class="list-group-item d-flex justify-content-between"><Label>전화번호</Label><strong th:text="${#authentication.principal.user.userPhone}"></strong></li>
			</ul>
		</div>
	</div>
	<br>
	<div class="card info-card p-4">
		<h6 class="card-title">
			보안 정보 <a href="mypage" data-bs-toggle="tooltip"
				data-bs-placement="right" title="보안정보 수정"><i
				class="fa-solid fa-pen-to-square"></i></a>
		</h6>
		<div class="card-body">
			<ul class="list-group list-group-flush">
				<li class="list-group-item d-flex justify-content-between"><Label>비밀번호</Label><strong>********</strong></li>
				<li class="list-group-item d-flex justify-content-between"><Label>소셜로그인</Label><strong>연동여부</strong></li>
			</ul>
		</div>
	</div>
	<br>
	<div class="card info-card p-4">
		<h6 class="card-title">
			내가 쓴 리뷰 <a href="#" data-bs-toggle="tooltip"
				data-bs-placement="right" title="리뷰 관리"><i
				class="fa-solid fa-pen-to-square"></i></a>
		</h6>
	</div>
	<br>
	<div class="card info-card p-4">
		<h6 class="card-title">
			내 주소 <a href="#" data-bs-toggle="tooltip" data-bs-placement="right"
				title="주소 관리"><i class="fa-solid fa-pen-to-square"></i></a>
		</h6>
	</div>

</div>
</html>
